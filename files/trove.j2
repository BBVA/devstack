# Set up default directories
TROVE_DIR=${DEST}/trove
TROVE_REPO=${GIT_BASE}/openstack/trove.git
TROVE_BRANCH={{ service.release|default("$DEVSTACK_RELEASE") }}

TROVECLIENT_DIR=${DEST}/python-troveclient

TROVE_CLIENT_DIR=$TROVECLIENT_DIR
TROVE_CLIENT_REPO=${GIT_BASE}/openstack/python-troveclient.git
TROVE_CLIENT_BRANCH={{ service.release|default("$DEVSTACK_RELEASE") }}

TROVE_DASHBOARD_DIR=${DEST}/trove-dashboard
TROVE_DASHBOARD_REPO=${GIT_BASE}/openstack/trove-dashboard.git
TROVE_DASHBOARD_BRANCH={{ service.release|default("$DEVSTACK_RELEASE") }}

# Set up configuration directory and files
TROVE_CONF_DIR=/etc/trove
TROVE_CONF=${TROVE_CONF_DIR}/trove.conf
TROVE_TASKMANAGER_CONF=${TROVE_CONF_DIR}/trove-taskmanager.conf
TROVE_CONDUCTOR_CONF=${TROVE_CONF_DIR}/trove-conductor.conf
TROVE_GUESTAGENT_CONF=${TROVE_CONF_DIR}/trove-guestagent.conf
TROVE_API_PASTE_INI=${TROVE_CONF_DIR}/api-paste.ini
TROVE_POLICY_JSON=${TROVE_CONF_DIR}/policy.json

TROVE_LOCAL_CONF_DIR=${TROVE_DIR}/etc/trove
TROVE_LOCAL_API_PASTE_INI=${TROVE_LOCAL_CONF_DIR}/api-paste.ini
TROVE_LOCAL_POLICY_JSON=${TROVE_LOCAL_CONF_DIR}/policy.json
TROVE_AUTH_CACHE_DIR=/var/cache/trove
TROVE_DATASTORE_TYPE=mysql
TROVE_DATASTORE_VERSION=5.6
TROVE_DATASTORE_PACKAGE=mysql-server-5.6

# Configuration values listed here for reference
TROVE_MAX_ACCEPTED_VOLUME_SIZE=${TROVE_MAX_ACCEPTED_VOLUME_SIZE}
TROVE_MAX_INSTANCES_PER_TENANT=${TROVE_MAX_INSTANCES_PER_TENANT}
TROVE_MAX_VOLUMES_PER_TENANT=${TROVE_MAX_VOLUMES_PER_TENANT}
TROVE_AGENT_CALL_LOW_TIMEOUT=${TROVE_AGENT_CALL_LOW_TIMEOUT}
TROVE_AGENT_CALL_HIGH_TIMEOUT=${TROVE_AGENT_CALL_HIGH_TIMEOUT}
TROVE_RESIZE_TIME_OUT=${TROVE_RESIZE_TIME_OUT}
TROVE_USAGE_TIMEOUT=${TROVE_USAGE_TIMEOUT}
TROVE_STATE_CHANGE_WAIT_TIME=${TROVE_STATE_CHANGE_WAIT_TIME}

TROVE_PRIVATE_NETWORK_NAME=alt-private
TROVE_HOST_GATEWAY=${NETWORK_GATEWAY:-10.0.0.1}

# Tell Tempest this project is present
TEMPEST_SERVICES+=,trove

enable_plugin trove ${GIT_BASE}/openstack/trove {{ service.release|default("$DEVSTACK_RELEASE") }}
enable_service trove tr-api tr-tmgr tr-cond

if is_service_enabled horizon; then
  echo_summary "Installing Trove dashboard"
  enable_service trove-dashboard

